#ifndef _ADG731_1_H
#define	_ADG731_1_H

#include <xc.h>
#include <stdlib.h>
#include <stdint.h>
#include <stdlib.h>
#include <stdbool.h>
#include <stddef.h>
#include <string.h>
#include <limits.h>


/**********************************************************************************************************************************/
/*=== PIN ASSIGNMENTS ============================================================================================================*/
/**********************************************************************************************************************************/
#define sw1CsPin()                 (LATFbits.LATF2)                             // SW CS pin
#define sw1SpiOpenFrame()          (sw1CsPin() = 0)                             // SW SPI frame open
#define sw1SpiCloseFrame()         (sw1CsPin() = 1)                             // SW SPI frame close


/**********************************************************************************************************************************/
/*=== SYSTEM ASSIGNMENTS =========================================================================================================*/
/**********************************************************************************************************************************/
#define sw1SpiBuf()                SPI2BUF                                      // SPI hardware buffer in use
#define sw1SpiTxBufFull()          SPI2STATbits.SPITBF                          // SPI transmit buffer full flag
#define sw1SpiRxBufEmpty()         SPI2STATbits.SPIRBE                          // SPI receive buffer empty flag
#define sw1SpiBusy()               SPI2STATbits.SPIBUSY                         // SPI busy flag
#define sw1SpiCon()                (SPI2CON)                                    // SPIxCON associated with allocated SPI port
#define sw1SpiCon2()               (SPI2CON2)                                   // SPIxCON2 associated with allocated SPI port
#define sw1SpiBrg()                (SPI2BRG)                                    // SPIxBRG associated with allocated SPI port

/**********************************************************************************************************************************/
/*=== MACROS =====================================================================================================================*/
/**********************************************************************************************************************************/
#define sw1BufSize()              (UINT8_MAX+1)                                 // Soft buffer size
#define sw1CmdSize()              1                                             // command size
#define sw1Min()                  0                                             // Number of sw1itches
#define sw1Max()                  31                                            // Number of sw1itches
#define sw1Off()                  0                                             // Switch off identifier
#define sw1On()                   1                                             // Switch on idenfitifer

/*=== SWITCH STATE VALUES ========================================================================================================*/
#define sw1WriteState()           0x00                                          // State machine write state

/**********************************************************************************************************************************/
/*=== VARIABLES ==================================================================================================================*/
/**********************************************************************************************************************************/
typedef struct{
    uint8_t tx[sw1BufSize()];                                                    // TX soft buffer
    uint8_t txStart;                                                            // TX soft buffer start index
    uint8_t txEnd;                                                              // TX soft buffer end index    
    uint8_t state;                                                              // State machine state variable
    uint8_t actv;                                                               // Active sw1itch number
} sw1_obj;

/**********************************************************************************************************************************/
/*=== FUNCTION PROTOTYPES ========================================================================================================*/
/**********************************************************************************************************************************/

/*** sw1SpiInit *******************************************************************************************************************/
void sw1SpiInit(void);

/*** sw1SpiRxFifoClear ************************************************************************************************************/
void sw1SpiRxFifoClear(void);

/*** sw1Initialize ****************************************************************************************************************/
void sw1Initialize(void);

/*** sw1Sel ***********************************************************************************************************************/
bool sw1Sel(uint8_t sw1Num);

/*** sw1TxBytes *******************************************************************************************************************/
uint8_t sw1TxBytes(void);

/*** sw1Service *******************************************************************************************************************/
void sw1Service(void);

#endif                                                                          // End _ADG731_1_H